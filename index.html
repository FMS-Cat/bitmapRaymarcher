<!DOCTYPE html>

<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style>
      *
      {
        background : #000;
				color : #ddd;
      }
		</style>
	</head>
	<body>
		<div id="cont">
			<a href="samples/simple">simple</a>
			<a href="samples/repetition">repetition</a>
			<a href="samples/twist">twist</a>
			<a href="samples/meta">meta</a>
		</div>
    <script src="lib/ItaPoly.js"></script>
	  <script src="lib/distanceTexture.js"></script>
		<script>
			function requestText( _url, _callback ){
				var xhr = new XMLHttpRequest();
				xhr.open( 'GET', _url, true );
				xhr.responseType = 'text';
				xhr.onload = function( _e ){
					_callback( this.response );
				};
				xhr.send();
			}

			var canvas = document.createElement( 'canvas' );
			canvas.width = 512;
			canvas.height = 128;
			var context = canvas.getContext( '2d' );
			context.fillStyle = '#ffffff';
			context.fillRect( 0, 0, 512, 128 );
			context.fillStyle = '#000000';
			context.font = '72px Comic Sans MS';
			context.textAlign = 'center';
			context.textBaseline = 'middle';
			context.fillText( 'Samples', 256, 64 );
      createDistanceTexture( canvas, 512, 128, function( _texture ){
				bitmap = _texture;
			} );

      var width = 512;
      var height = 128;
			var itaPolyMarch = new ItaPoly( width, height );
			document.body.insertBefore( itaPolyMarch.canvas, document.getElementById( 'cont' ) );

			requestText( 'raymarch.frag', function( _text ){
				itaPolyMarch.createProgram( _text, function(){
					function update(){
						itaPolyMarch.setSampler2D( 'texture', bitmap );
						itaPolyMarch.update();
						requestAnimationFrame( update );
					}
					update();
				} );
			} );
		</script>
	</body>
</html>
